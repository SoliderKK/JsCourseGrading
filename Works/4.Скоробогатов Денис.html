<!DOCTYPE html>
<html>
  <head>
    <title>Задание для демодня</title>
    <meta charset="utf-8" />
  </head>
  <body>
    <script>
      'use strict'

      while (true) {
        let m = prompt('Введите целое число');

        if (m == null) {
          console.log('Вы прервали выполнение программы');
          break;
        } else if (m.trim() == '') {
          console.log('Пустая строка');
          continue;
        } else m = +m;

        if (Number.isNaN(m)) {
          console.log('Ошибка! Введен текст');
          continue;
        } else if (m < 0) {
          console.log('Ошибка! Введено отрицательное число');
          continue;
        } else if (m == 0) {
            console.log('Введено нулевое значение');
            continue;
        } else if (Number.isInteger(m)) {
            let a = [];
            let i, j;

            for (i = 0; i < 2*m; i++) {
              a[i] = [];
              for (j = 0; j < m; j++) {
                a[i][j] = Math.random();
              }
            }

            console.log('Матрица A(2M, M) =', a);

            let topHalf = [];

            for (i = 0; i < m; i++) {
              topHalf[i] = a[i];
            }

            let bottomHalf = [];

            for (i = m; i < 2*m; i++) {
              bottomHalf[i - m] = a[i];
            }

            let topHalfMultiplication = 1;

            for (i = 0; i < m; i++) {
              for (j = 0; j < m; j++) {
                topHalfMultiplication *= topHalf[i][j];
              }
            }

            let bottomHalfMultiplication = 1;

            for (i = m; i < 2*m; i++) {
              for (j = 0; j < m; j++) {
                bottomHalfMultiplication *= bottomHalf[i - m][j - m];
              }
            }

            if (topHalfMultiplication > bottomHalfMultiplication) {
              console.log('Произведение элементов верхней половины матрицы\n' +
                          'больше произведения нижней');
            } else {
                console.log('Произведение элементов нижней половины матрицы\n' +
                          'больше произведения верхней');
            }

            let b = [];

            for (i = 0; i < m; i++) {
              b[i] = []
              for (j = 0; j < m; j++) {
                b[i][j] = bottomHalf[i][j] * topHalf[i][j];
              }
            }

            let bSort = [];
            let k = 0;

            for (i = 0; i < m; i++) {
              for (j = 0; j < m; j++) {
                bSort[k++] = b[i][j];
              }
            }

            let x, left, right, mid;

            for (i = 1; i < bSort.length; i++) {
              x = bSort[i];
              left = 0;
              right = i - 1;

              while(left <= right) {
                mid = Math.floor((left + right) / 2);
                if (x < bSort[mid]) right = mid - 1;
                else left = mid + 1;
              }

              for (j = i - 1; j >= left; j--) {
                bSort[j+1] = bSort[j];
                }

              bSort[left] = x;
            }

            console.log('Матрица B(M,M) =' , b);
            console.log('Матрица B1 =', bSort);
          } else {
              console.log('Ошибка! Введено вещественное число');
              continue;
          } break;
        }
    </script>
  </body>
</html>